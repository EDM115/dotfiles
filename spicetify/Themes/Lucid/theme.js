(async function() {while (!Spicetify.React || !Spicetify.ReactDOM) {await new Promise(resolve => setTimeout(resolve, 10));}var lucid=(()=>{var Qo=Object.create;var tt=Object.defineProperty;var er=Object.getOwnPropertyDescriptor;var tr=Object.getOwnPropertyNames;var or=Object.getPrototypeOf,rr=Object.prototype.hasOwnProperty;var Fe=(e,o)=>()=>(o||e((o={exports:{}}).exports,o),o.exports);var nr=(e,o,t,r)=>{if(o&&typeof o=="object"||typeof o=="function")for(let n of tr(o))!rr.call(e,n)&&n!==t&&tt(e,n,{get:()=>o[n],enumerable:!(r=er(o,n))||r.enumerable});return e};var p=(e,o,t)=>(t=e!=null?Qo(or(e)):{},nr(o||!e||!e.__esModule?tt(t,"default",{value:e,enumerable:!0}):t,e));var u=Fe((Un,ot)=>{ot.exports=Spicetify.React});var co=Fe((ms,lo)=>{"use strict";var Kr="bold|bolder|lighter|[1-9]00",Qr="italic|oblique",en="small-caps",tn="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",on="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",so=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,rn=new RegExp(`(${Kr}) +`,"i"),nn=new RegExp(`(${Qr}) +`,"i"),an=new RegExp(`(${en}) +`,"i"),sn=new RegExp(`(${tn}) +`,"i"),ln=new RegExp(`([\\d\\.]+)(${on}) *((?:${so})( *, *(?:${so}))*)`),Je={},cn=16;lo.exports=e=>{if(Je[e])return Je[e];let o=ln.exec(e);if(!o)return;let t={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(o[1]),unit:o[2],family:o[3].replace(/["']/g,"").replace(/ *, */g,",")},r,n,i,a,c=e.substring(0,o.index);switch((r=rn.exec(c))&&(t.weight=r[1]),(n=nn.exec(c))&&(t.style=n[1]),(i=an.exec(c))&&(t.variant=i[1]),(a=sn.exec(c))&&(t.stretch=a[1]),t.unit){case"pt":t.size/=.75;break;case"pc":t.size*=16;break;case"in":t.size*=96;break;case"cm":t.size*=96/2.54;break;case"mm":t.size*=96/25.4;break;case"%":break;case"em":case"rem":t.size*=cn/.75;break;case"q":t.size*=96/25.4/4;break}return Je[e]=t}});var po=Fe(be=>{var dn=co();be.parseFont=dn;be.createCanvas=function(e,o){return Object.assign(document.createElement("canvas"),{width:e,height:o})};be.createImageData=function(e,o,t){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(e);case 2:return new ImageData(e,o);default:return new ImageData(e,o,t)}};be.loadImage=function(e,o){return new Promise(function(t,r){let n=Object.assign(document.createElement("img"),o);function i(){n.onload=null,n.onerror=null}n.onload=function(){i(),t(n)},n.onerror=function(){i(),r(new Error('Failed to load the image "'+e+'"'))},n.src=e})}});var L=p(u()),ir=(0,L.memo)(({title:e,children:o,headingChild:t,onClose:r,isOpen:n=!1})=>n?L.default.createElement("div",{className:"modal-container"},L.default.createElement("div",{className:`modal-overlay ${n&&"open"}`,style:{zIndex:20},onClick:r}),L.default.createElement("dialog",{open:n,className:`modal-section ${n&&"open"}`,"aria-label":e,"aria-modal":"true"},L.default.createElement("div",{className:"main-embedWidgetGenerator-container"},L.default.createElement("div",{className:"main-trackCreditsModal-header"},L.default.createElement("h1",{className:"encore-text encore-title-body-medium"},e),t&&L.default.createElement("div",null,t),L.default.createElement("button",{type:"button","aria-label":"Close",className:"main-trackCreditsModal-closeBtn",onClick:()=>r()},L.default.createElement("svg",{width:"18",height:"18",viewBox:"0 0 32 32",xmlns:"http://www.w3.org/2000/svg"},L.default.createElement("title",null,"Close"),L.default.createElement("path",{d:"M31.098 29.794L16.955 15.65 31.097 1.51 29.683.093 15.54 14.237 1.4.094-.016 1.508 14.126 15.65-.016 29.795l1.414 1.414L15.54 17.065l14.144 14.143",fill:"currentColor","fill-rule":"evenodd"})))),L.default.createElement("div",{className:"modal-contents"},L.default.createElement("main",{className:"modal-wrapper"},o))))):null),ve=ir;var me=p(u()),ar=({title:e,description:o,children:t})=>me.default.createElement("div",{className:"setting-section"},me.default.createElement("div",{className:"heading-wrapper"},me.default.createElement("h3",{className:"title encore-text encore-text-title-small"},e),o&&me.default.createElement("p",{className:"desc encore-text encore-text-body-small"},o)),t),V=ar;var rt=[{label:"Animated",value:"animated"},{label:"Static",value:"static"},{label:"Solid",value:"solid"}],nt=[{label:"Compact",value:"compact"},{label:"Default",value:"default"},{label:"Rounded",value:"rounded"}],it=[{label:"Starry",value:"starry"},{label:"Default",value:"default"},{label:"none",value:"none"}],at=[{label:"Now Playing",value:"now-playing"},{label:"Playlist Cover",value:"inherit"},{label:"none",value:"none"}],st=[{label:"Card",value:"card"},{label:"Compact Card",value:"compact-card"},{label:"Compact",value:"compact"},{label:"Default",value:"default"}],lt=[{label:"None",value:"none"},{label:"Hidden",value:"hidden"},{label:"Dotted",value:"dotted"},{label:"Dashed",value:"dashed"},{label:"Solid",value:"solid"},{label:"Double",value:"double"},{label:"Groove",value:"groove"},{label:"Ridge",value:"ridge"},{label:"Inset",value:"inset"},{label:"Outset",value:"outset"}];var ct=[{label:"Profile Context Menu",value:"context-menu"},{label:"Global Nav",value:"nav"}],dt=[{label:"Compact",value:"compact"},{label:"Normal",value:"normal"}],pt=[{label:"Left",value:"left"},{label:"Right",value:"right"}];var Ve=p(u()),sr=()=>Ve.default.createElement("svg",{role:"img","aria-label":"dismiss",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Ve.default.createElement("path",{d:"m4.21 4.387.083-.094a1 1 0 0 1 1.32-.083l.094.083L12 10.585l6.293-6.292a1 1 0 1 1 1.414 1.414L13.415 12l6.292 6.293a1 1 0 0 1 .083 1.32l-.083.094a1 1 0 0 1-1.32.083l-.094-.083L12 13.415l-6.293 6.292a1 1 0 0 1-1.414-1.414L10.585 12 4.293 5.707a1 1 0 0 1-.083-1.32l.083-.094-.083.094Z",fill:"#ffffff"})),ut=sr;var He=p(u()),lr=({variant:e="primary",size:o="medium",icon:t,children:r,...n})=>He.default.createElement("button",{className:`button button-${e} button-${o}`,...n},t&&He.default.createElement("span",{className:"button-icon"},t),r),W=lr;var z=p(u()),cr=0,dr=(()=>{let e;return{ToastContainer:()=>{let[t,r]=(0,z.useState)([]);e=(0,z.useCallback)((a,c=!1)=>{let l=cr++;r(s=>[...s,{id:l,message:a,isError:c,exiting:!1}]);let d=setTimeout(()=>{i(l)},3e3);return()=>clearTimeout(d)},[]);let i=a=>{r(c=>c.map(l=>l.id===a?{...l,exiting:!0}:l)),setTimeout(()=>{r(c=>c.filter(l=>l.id!==a))},500)};return z.default.createElement("div",{className:"toast-container"},t.map(a=>z.default.createElement("div",{key:a.id,className:`toast-element ${a.exiting?"toast-exit":""}`,style:{backgroundColor:`${a.isError?"rgba(200,20,20,0.5)":"rgba(20,20,20,0.5)"}`}},a.message,z.default.createElement(W,{icon:z.default.createElement(ut,null),onClick:()=>i(a.id)}))))},addToast:(t,r)=>e(t,r)}})(),{ToastContainer:mt,addToast:O}=dr;var gt=e=>{let o,t=new Set,r=(d,s)=>{let m=typeof d=="function"?d(o):d;if(!Object.is(m,o)){let g=o;o=s??(typeof m!="object"||m===null)?m:Object.assign({},o,m),t.forEach(f=>f(o,g))}},n=()=>o,c={setState:r,getState:n,getInitialState:()=>l,subscribe:d=>(t.add(d),()=>t.delete(d))},l=o=e(r,n,c);return c},ft=e=>e?gt(e):gt;var je=p(u(),1);var pr=e=>e;function ur(e,o=pr){let t=je.default.useSyncExternalStore(e.subscribe,()=>o(e.getState()),()=>o(e.getInitialState()));return je.default.useDebugValue(t),t}var yt=e=>{let o=ft(e),t=r=>ur(o,r);return Object.assign(t,o),t},ne=e=>e?yt(e):yt;function mr(e,o){let t;try{t=e()}catch{return}return{getItem:n=>{var i;let a=l=>l===null?null:JSON.parse(l,o?.reviver),c=(i=t.getItem(n))!=null?i:null;return c instanceof Promise?c.then(a):a(c)},setItem:(n,i)=>t.setItem(n,JSON.stringify(i,o?.replacer)),removeItem:n=>t.removeItem(n)}}var Ge=e=>o=>{try{let t=e(o);return t instanceof Promise?t:{then(r){return Ge(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Ge(r)(t)}}}},gr=(e,o)=>(t,r,n)=>{let i={storage:mr(()=>localStorage),partialize:b=>b,version:0,merge:(b,k)=>({...k,...b}),...o},a=!1,c=new Set,l=new Set,d=i.storage;if(!d)return e((...b)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...b)},r,n);let s=()=>{let b=i.partialize({...r()});return d.setItem(i.name,{state:b,version:i.version})},m=n.setState;n.setState=(b,k)=>{m(b,k),s()};let g=e((...b)=>{t(...b),s()},r,n);n.getInitialState=()=>g;let f,M=()=>{var b,k;if(!d)return;a=!1,c.forEach(y=>{var x;return y((x=r())!=null?x:g)});let S=((k=i.onRehydrateStorage)==null?void 0:k.call(i,(b=r())!=null?b:g))||void 0;return Ge(d.getItem.bind(d))(i.name).then(y=>{if(y)if(typeof y.version=="number"&&y.version!==i.version){if(i.migrate){let x=i.migrate(y.state,y.version);return x instanceof Promise?x.then(N=>[!0,N]):[!0,x]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,y.state];return[!1,void 0]}).then(y=>{var x;let[N,F]=y;if(f=i.merge(F,(x=r())!=null?x:g),t(f,!0),N)return s()}).then(()=>{S?.(f,void 0),f=r(),a=!0,l.forEach(y=>y(f))}).catch(y=>{S?.(void 0,y)})};return n.persist={setOptions:b=>{i={...i,...b},b.storage&&(d=b.storage)},clearStorage:()=>{d?.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>M(),hasHydrated:()=>a,onHydrate:b=>(c.add(b),()=>{c.delete(b)}),onFinishHydration:b=>(l.add(b),()=>{l.delete(b)})},i.skipHydration||M(),f||g},we=gr;var bt={isUseLocalImage:!1,selectedLocalImage:null},ie=ne(we(e=>({...bt,setUseLocalImage:o=>e(()=>({isUseLocalImage:o})),setSelectedLocalImage:o=>e(()=>({selectedLocalImage:o})),clearSelectedLocalImage:()=>e(()=>({...bt}))}),{name:"lucid-bg-image"}));var fr={solid:{opacity:1,backgroundColor:"var(--spice-main)"},static:{blur:32,opacity:1,saturation:1.1,contrast:1.2,brightness:.5},animated:{blur:32,time:45,opacity:1,saturation:1.1,contrast:1.2,brightness:.475}},yr={compact:{height:64,opacity:1,saturation:1.1,contrast:1.2,brightness:.8,borderRadius:8,backdropBlur:32,paddingX:6,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"},default:{height:80,opacity:1,paddingX:6,saturation:1.1,contrast:1.2,borderRadius:8,brightness:.8,backdropBlur:32,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"},rounded:{height:80,opacity:1,paddingX:20,saturation:1.1,contrast:1.2,borderRadius:999,brightness:.8,backdropBlur:32,backgroundColor:"rgba(var(--spice-rgb-player, var(--spice-rgb-card)), 0.5)"}},Ce={backgroundSettings:{mode:"static",styles:fr,customBackgroundOverride:{url:null}},interfaceSettings:{controlSettings:{height:64},fontSettings:{body:{url:"https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap",fontFamily:"Poppins"}},grainSettings:{grainEffect:"default"},pagesSettings:{isScrollMode:!1,backgroundImageMode:"inherit",playlistViewMode:"card"},borderSettings:{color:"rgba(var(--spice-rgb-selected-row, var(--spice-rgb-text)), 0.125)",style:"inset",thickness:1,roundedRadius:12}},npvSettings:{mode:"normal",position:"right",blur:24},colorSettings:{isDynamicColor:!1},playbarSettings:{mode:"default",styles:yr},settingAccessPosition:"nav"};var br=e=>typeof e=="object"&&e!==null&&"backgroundSettings"in e&&"interfaceSettings"in e&&"playbarSettings"in e&&"colorSettings"in e&&typeof e.backgroundSettings=="object"&&"mode"in e.backgroundSettings&&"styles"in e.backgroundSettings&&typeof e.interfaceSettings=="object"&&"borderSettings"in e.interfaceSettings&&"fontSettings"in e.interfaceSettings&&typeof e.playbarSettings=="object"&&"mode"in e.playbarSettings&&typeof e.colorSettings=="object"&&"isDynamicColor"in e.colorSettings,h=ne(we((e,o)=>({...Ce,exportSettings:()=>{let t=o();return JSON.stringify(t)},importSettings:t=>{try{let r=JSON.parse(t);if(!br(r))throw new Error("Invalid settings structure");return e(r),O("Settings imported successfully!"),!0}catch(r){let n=r instanceof SyntaxError?"Failed to parse JSON: Please ensure your input is valid JSON.":r instanceof Error?r.message:"An unknown error occurred.";return O(n,!0),!1}},setBackgroundSettings:t=>e(r=>({backgroundSettings:{...r.backgroundSettings,...t}})),setNpvMode:t=>e(r=>({npvSettings:{...r.npvSettings,mode:t}})),setNpvBlur:t=>e(r=>({npvSettings:{...r.npvSettings,blur:t}})),setCompactNpvPosition:t=>e(r=>({npvSettings:{...r.npvSettings,position:t}})),setSettingAccessPosition:t=>e(()=>({settingAccessPosition:t})),setControlHeight:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,controlSettings:{height:t}}})),setCustomBackgroundOverride:t=>e(r=>({backgroundSettings:{...r.backgroundSettings,customBackgroundOverride:{...r.backgroundSettings.customBackgroundOverride,url:t}}})),setBorderColor:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,color:t}}})),setBorderStyle:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,style:t}}})),setRoundedBorderRadius:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,roundedRadius:t}}})),setBorderThickness:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,thickness:t}}})),setBackgroundStyles:(t,r)=>e(n=>({backgroundSettings:{...n.backgroundSettings,styles:{...n.backgroundSettings.styles,[r]:{...n.backgroundSettings.styles[r],...t}}}})),setColorSettings:t=>e(r=>({colorSettings:{...r.colorSettings,...t}})),setBorderSettings:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,borderSettings:{...r.interfaceSettings.borderSettings,...t}}})),setPlaybarSettings:t=>e(r=>({playbarSettings:{...r.playbarSettings,...t}})),setInterfaceSettings:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,...t}})),setBackgroundMode:t=>e(r=>({backgroundSettings:{...r.backgroundSettings,mode:t}})),updateBackgroundStyle:(t,r,n)=>e(i=>({backgroundSettings:{...i.backgroundSettings,styles:{...i.backgroundSettings.styles,[t]:{...i.backgroundSettings.styles[t],[r]:n}}}})),setFont:(t,r)=>e(n=>({interfaceSettings:{...n.interfaceSettings,fontSettings:{...n.interfaceSettings.fontSettings,[t]:{...r}}}})),setGrainEffect:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,grainSettings:{...r.interfaceSettings.grainSettings,grainEffect:t}}})),setIsScrollMode:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,pagesSettings:{...r.interfaceSettings.pagesSettings,isScrollMode:t}}})),setPagesBackgroundImageMode:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,pagesSettings:{...r.interfaceSettings.pagesSettings,backgroundImageMode:t}}})),setPlaylistViewMode:t=>e(r=>({interfaceSettings:{...r.interfaceSettings,pagesSettings:{...r.interfaceSettings.pagesSettings,playlistViewMode:t}}})),setIsDynamicColor:t=>e(r=>({colorSettings:{...r.colorSettings,isDynamicColor:t}})),updatePlaybarStyle:(t,r,n)=>e(i=>({playbarSettings:{...i.playbarSettings,styles:{...i.playbarSettings.styles,[t]:{...i.playbarSettings.styles[t],[r]:n}}}})),setPlaybarMode:t=>e(r=>({playbarSettings:{...r.playbarSettings,mode:t}})),resetAllSettings:()=>{e(Ce)}}),{name:"lucid-settings",version:1.1,migrate:e=>({...Ce,...e})}));var We=e=>{try{return new URL(e),!0}catch{return!1}},Sr=e=>decodeURIComponent(e.match(/family=([^&:]+)/)?.[1]?.replace(/\+/g," ")||"")||"",St=(e,o)=>{let t=document.getElementById(o);t||(t=document.createElement("link"),t.rel="stylesheet",t.id=o,document.head.appendChild(t)),t.href=e},ht=e=>{let o="",t="";return We(e)?(t=e,o=Sr(e)):(t=e,o=e),{url:t,fontFamily:o}};var ke=(e,o,t)=>Object.entries(e[o]).map(([r,n])=>({id:`style-${o}`,sectionName:"Styles",conditionalRender:!0,cardProps:{title:`Set ${r}`,type:"input",settings:{label:"",defaultValue:n,...typeof n=="number"?{type:"number",onChange:i=>{t(o,r,Number(i))},settings:{max:256,min:0,step:.5}}:{type:"text",onChange:i=>{t(o,r,i)}}}}}));var hr=console.log,vr=console.debug,wr=console.error,Cr=console.warn,vt={prefix:"font-weight: bold; color: #4DB6AC; font-size: 0.85rem;",error:"color: #dc3545;",warn:"color: #ffc107;",debug:"color: #17a2b8;",info:""},Me=(e,o,...t)=>{let r={info:hr,debug:vr,error:wr,warn:Cr}[e],n=vt[e];r(`%c[Lucid] %c${o}`,vt.prefix,n,...t)},H=(e,...o)=>Me("info",e,...o),w=(e,...o)=>Me("debug",e,...o),C=(e,...o)=>Me("error",e,...o),xe=(e,...o)=>Me("warn",e,...o);var ee=p(u()),kr=({children:e})=>ee.default.createElement("div",{className:"tooltip-container"},ee.default.createElement("div",{className:"tooltip"},ee.default.createElement("span",{className:"tooltip-icon"},ee.default.createElement("svg",{role:"img","aria-label":"Tooltip icon",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},ee.default.createElement("path",{d:"M12 2c5.523 0 10 4.478 10 10s-4.477 10-10 10S2 17.522 2 12 6.477 2 12 2Zm0 1.667c-4.595 0-8.333 3.738-8.333 8.333 0 4.595 3.738 8.333 8.333 8.333 4.595 0 8.333-3.738 8.333-8.333 0-4.595-3.738-8.333-8.333-8.333ZM12 15.5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Zm0-8.75a2.75 2.75 0 0 1 2.75 2.75c0 1.01-.297 1.574-1.051 2.359l-.169.171c-.622.622-.78.886-.78 1.47a.75.75 0 0 1-1.5 0c0-1.01.297-1.574 1.051-2.359l.169-.171c.622-.622.78-.886.78-1.47a1.25 1.25 0 0 0-2.493-.128l-.007.128a.75.75 0 0 1-1.5 0A2.75 2.75 0 0 1 12 6.75Z",fill:"currentColor"}))),ee.default.createElement("span",{className:"tooltip-content"},e))),wt=kr;var ae=p(u()),Mr=({title:e,tooltip:o,selectedValue:t})=>ae.default.createElement("div",{className:"title-container"},ae.default.createElement("div",{className:"title-wrapper"},e&&ae.default.createElement("h5",{className:"encore-text encore-text-body-medium-bold"},e),o&&ae.default.createElement(wt,null,o)),t&&ae.default.createElement("p",{className:"selected-value"},"Selected: ",t)),Ct=Mr;var ze=p(u()),xr=()=>ze.default.createElement("svg",{role:"img","aria-label":"Arrow Down",width:"24",height:"24",fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},ze.default.createElement("path",{d:"M4.293 8.293a1 1 0 0 1 1.414 0L12 14.586l6.293-6.293a1 1 0 1 1 1.414 1.414l-7 7a1 1 0 0 1-1.414 0l-7-7a1 1 0 0 1 0-1.414Z",fill:"#ffffff"})),kt=xr;var I=p(u()),Pr=({options:e,selectedValue:o,onChange:t,placeholder:r,disabled:n})=>{let i=(0,I.useRef)(null),[a,c]=(0,I.useState)(!1),l=()=>{c(s=>!s)},d=s=>{c(!1),t(s)};return(0,I.useEffect)(()=>{let s=m=>{i.current&&!i.current.contains(m.target)&&c(!1)};return document.addEventListener("mousedown",s),()=>document.removeEventListener("mousedown",s)},[]),I.default.createElement(I.default.Fragment,null,I.default.createElement("div",{className:"dropdown-container",ref:i},I.default.createElement("button",{className:`dropdown-button ${a?"open":""}`,onClick:l,"aria-label":"Toggle dropdown menu",type:"button"},I.default.createElement("p",{className:"encore-text"},r||o||"Dropdown"),I.default.createElement("span",{className:"dropdown-arrow"},I.default.createElement(kt,null))),I.default.createElement("div",{className:`dropdown-menu ${a?"open":""}`},a?e?.map(s=>I.default.createElement("li",{key:s.value,className:`dropdown-item ${o===s.value?"selected":""}`,onClick:()=>!s.disabled&&d(s.value),onKeyDown:m=>!s.disabled&&m.key==="Enter"&&d(s.value),style:{opacity:`${n?.75:1}`}},I.default.createElement("p",{className:"encore-text"},s.label))):null)))},Mt=Pr;var xt=(e,o)=>{let t=null;return(...r)=>{t&&clearTimeout(t),t=setTimeout(()=>{e(...r)},o)}};var _=p(u()),Ir=(0,_.forwardRef)(({label:e,defaultValue:o,onChange:t,type:r,placeholder:n,settings:i,validation:a},c)=>{let[l,d]=(0,_.useState)(o||null),[s,m]=(0,_.useState)(null),g=r==="file",f=r==="number",M=(0,_.useMemo)(()=>xt(k=>{g||t?.(k)},1e3),[t,g]),b=(0,_.useCallback)(k=>{if(g){let S=k.target.files;t?.(S)}else if(f&&i){let S=Number(k.target.value),y=i.max??100,x=i.min??0;S>y?m(`Value cannot exceed ${y}`):S<x?m(`Value cannot be less than ${x}`):m(null);let N=Math.min(Math.max(S,x),y).toString();d(N),M(N)}else{let S=k.target.value;d(S),m(null),M(S)}},[M,i,g,f,t]);return(0,_.useEffect)(()=>{s&&O(s,!0)},[s]),_.default.createElement("div",{className:"input-container"},_.default.createElement("label",{"aria-label":e,className:g?"input":"label"},_.default.createElement("input",{"aria-label":e,type:r,accept:g?i?.accept??"image/*":void 0,multiple:g?i?.multiple??!1:void 0,className:"input encore-text",value:l??"",onChange:b,placeholder:n,step:f?i?.step??1:void 0,min:f?i?.min:void 0,max:f?i?.max:void 0,ref:c,style:g?{display:"none"}:{}}),g?"Upload Image":null))}),Pe=Ir;var ge=p(u()),Er=({onChange:e,checked:o,label:t})=>ge.default.createElement("div",{className:"slider-wrapper"},ge.default.createElement("label",{className:"switch","aria-label":t},ge.default.createElement("input",{"aria-label":"toggleSwtich",type:"checkbox",checked:o,onChange:()=>{e(!o)}}),ge.default.createElement("span",{className:"slider round"}))),Pt=Er;var Z=p(u()),Lr=({title:e,tooltip:o,selectedValue:t,type:r,settings:n,children:i,style:a})=>Z.default.createElement("div",{className:"card"},Z.default.createElement(Ct,{title:e,tooltip:o,selectedValue:t}),Z.default.createElement("div",{className:"children-wrapper",style:a||{}},r==="dropdown"&&Z.default.createElement(Mt,{...n}),r==="input"&&Z.default.createElement(Pe,{...n}),r==="toggle"&&Z.default.createElement(Pt,{...n}),r==="button"&&Z.default.createElement(W,{...n}),i)),fe=Lr;var It=p(u()),Tr=e=>{let{children:o,className:t,...r}=e;return It.default.createElement("div",{...r,className:`cards-wrapper ${t||""}`},o)},Ie=Tr;var te=p(u()),J=e=>{let[o,t]=(0,te.useState)(new Map);return te.default.useEffect(()=>{let r=new Map;for(let n of e)r.has(n.id)||r.set(n.id,[]),r.get(n.id)?.push(n);t(r)},[e]),Array.from(o.entries()).map(([r,n])=>{let i=n.filter(a=>a.conditionalRender);return i.length>0?te.default.createElement(Ie,{key:r,id:r,className:`${r} combine`},i[0]?.sectionName?te.default.createElement("label",{"aria-label":i[0]?.sectionName,htmlFor:r},i[0]?.sectionName):null,i.map(a=>te.default.createElement(fe,{key:a.id,...a.cardProps}))):null})};var P=p(u()),Nr=()=>{let{backgroundSettings:{mode:e,styles:o,customBackgroundOverride:t},colorSettings:{isDynamicColor:r},setBackgroundMode:n,updateBackgroundStyle:i,setIsDynamicColor:a,setCustomBackgroundOverride:c}=h(),{isUseLocalImage:l,setUseLocalImage:d,clearSelectedLocalImage:s,selectedLocalImage:m,setSelectedLocalImage:g}=ie(),[f,M]=(0,P.useState)(e),k=[{id:"backgroundOption",conditionalRender:!0,cardProps:{title:"Background Option",type:"dropdown",tooltip:"Select the background mode to customize your background.",settings:{placeholder:f,selectedValue:f,options:rt,onChange:S=>{M(S),n(S)}}}},...ke(o,e,i),{id:"backgroundCustomImage",sectionName:"Custom Background",conditionalRender:e==="static",cardProps:{title:"Background image",type:"input",tooltip:P.default.createElement(P.default.Fragment,null,P.default.createElement("span",null,"Use a custom URL for the background image."),P.default.createElement("span",null,"Ensure the URL is a valid image link (e.g., .jpg, .png)."),P.default.createElement("span",null,'Use "now-playing" for the now playing art image.'),P.default.createElement("span",null,'Use "current-page" for the current page art image.')),settings:{type:"text",defaultValue:t?.url||"",label:"Url",validation:S=>We(S),onChange:S=>{c(S)}}}},{id:"backgroundCustomImage",conditionalRender:e==="static",cardProps:{title:"Use Local Image",type:"toggle",tooltip:P.default.createElement(P.default.Fragment,null,P.default.createElement("p",null,"Import an image from your device to use as the background."),m?.dataURL?P.default.createElement("div",null,P.default.createElement("img",{width:"20rem",src:m.dataURL,alt:`${m?.fileName} img`,style:{display:"block",width:"20rem",borderRadius:"0.5rem",border:"var(--border-thickness) var(--border-style, solid) var(--border-color, rgba(var(--spice-rgb-text), 0.125))"}}),m?.fileName?P.default.createElement("p",null,"File name: ",P.default.createElement("span",null,m.fileName)):null,m?.dateAdded?P.default.createElement("p",null,"Date Added: ",P.default.createElement("span",null,m.dateAdded)):null):null),settings:{checked:l,label:"Enable Local Image",onChange:S=>{d(S)}}}},{id:"backgroundCustomImageInput",conditionalRender:e==="static"&&l,cardProps:{title:"Select Background Image",type:"input",tooltip:"Choose an image file from your device.",settings:{type:"file",label:"Choose File",onChange:S=>{let y=S?.[0];if(y){let x=new FileReader;x.readAsDataURL(y),x.onload=N=>{let F=N.target?.result||"";w("Local Image Data URL:",F),O(P.default.createElement("div",{style:{display:"flex",alignItems:"center"}},P.default.createElement("span",{style:{marginRight:"10px"}},"Successfully Added Local Image as background from File name:"),P.default.createElement("span",{style:{fontWeight:"bold"}},y.name))),g({dataURL:F,fileName:y.name||"",dateAdded:new Date().toLocaleString()})}}}}}},{id:"dynamicColorToggle",conditionalRender:!0,cardProps:{title:"Dynamic Color",type:"toggle",tooltip:"Enable dynamic color to adjust colors based on current playing album art.",settings:{checked:r,label:"Dynamic Color Toggle",onChange:S=>{a(S),S&&O("Enabled Dynamic Color.")}}}}];return P.default.createElement(V,{title:"Background Settings",description:"Set your Spotify interface settings."},J(k))},Et=Nr;var R=p(u()),_r=()=>{let{exportSettings:e,importSettings:o}=h(),[t,r]=(0,R.useState)(!1),n=(0,R.useRef)(null),i=()=>{r(d=>!d),t&&n.current&&(n.current.value="")},a=()=>{let d=n.current?.value.trim()||"{}";if(d==="{}"){O("Please enter valid JSON settings.",!0);return}o(d)};return R.default.createElement(V,{title:"Settings Import/Export",description:"Manage your settings easily."},R.default.createElement(Ie,null,R.default.createElement(fe,{title:"Import and Export Settings",type:"normal",tooltip:"Use these buttons to import settings from a JSON file or export your current theme settings to your clipboard.",style:{display:"flex",gap:"0.5rem"}},R.default.createElement(W,{onClick:()=>{let d=e();navigator.clipboard.writeText(d).then(()=>{O("Settings exported to clipboard!")}).catch(s=>{C("Failed to copy: ",s),O("Failed to copy settings to clipboard.",!0)})}},"Export"),R.default.createElement(W,{onClick:i,variant:t?"danger":"primary"},t?"Cancel Import":"Import")),t&&R.default.createElement(fe,{title:"Import Settings JSON",type:"normal",tooltip:"Paste your JSON settings here to import them. Ensure the JSON is correctly formatted.",style:{display:"flex",gap:"0.5rem"}},R.default.createElement(W,{onClick:async()=>{try{let d=await navigator.clipboard.readText();n.current&&(n.current.value=d,a()),O("Clipboard content pasted successfully!")}catch(d){C("Failed to read clipboard: ",d),O("Failed to read clipboard content.",!0)}}},"Paste And Import"),R.default.createElement(Pe,{ref:n,type:"text",label:"Paste JSON here",placeholder:"Paste JSON here"}),R.default.createElement(W,{onClick:a},"Import"))))},Lt=_r;var Tt=()=>Spicetify.Platform&&Spicetify.Platform.operatingSystem==="Windows"?!0:Spicetify.Platform?.PlatformData?.os_name?Spicetify.Platform.PlatformData.os_name.toLowerCase().includes("win"):!1,Nt=()=>Spicetify?.Config.color_scheme==="light"||!1,_t=()=>!!(document.querySelector(".globalNav")||document.querySelector(".Root__globalNav"));async function At(e){try{Spicetify?.Platform?.ControlMessageAPI?._updateUiClient?.updateTitlebarHeight({height:e}),Spicetify?.Platform?.UpdateAPI?._updateUiClient?.updateTitlebarHeight({height:e}),Spicetify.CosmosAsync.post("sp://messages/v1/container/control",{type:"update_titlebar",height:`${e}px`}),H(`Control height set to ${e}px`)}catch(o){C(`Error setting control height: ${e}`,o)}}function Bt(){return document.getElementById("customControls")?(document.querySelector(".lucid-transperent-window-controls")?.remove(),!0):!1}var Ot="https://api.github.com/repos/sanoojes/spicetify-lucid/releases",Rt=".Root__main-view .os-viewport, .Root__main-view .main-view-container > .main-view-container__scroll-node:not([data-overlayscrollbars-initialize]), .Root__main-view .main-view-container__scroll-node > [data-overlayscrollbars-viewport]",Dt="playlist-art-image-",Ut="playlist-view-",qe=Spicetify?.Platform?.version>="1.2.46",$t=Nt(),oe=Tt(),Ft=_t(),Ee=Bt();var E=p(u()),Ar=()=>{let{interfaceSettings:{controlSettings:{height:e},fontSettings:{body:{fontFamily:o}},grainSettings:{grainEffect:t},pagesSettings:{isScrollMode:r,backgroundImageMode:n,playlistViewMode:i},borderSettings:{color:a,style:c,thickness:l,roundedRadius:d}},npvSettings:{mode:s,position:m,blur:g},setFont:f,setGrainEffect:M,setControlHeight:b,setPagesBackgroundImageMode:k,setPlaylistViewMode:S,setIsScrollMode:y,setNpvMode:x,setNpvBlur:N,setCompactNpvPosition:F,setBorderColor:ue,setBorderStyle:zo,setBorderThickness:qo,settingAccessPosition:Ye,setRoundedBorderRadius:Zo,setSettingAccessPosition:Jo}=h(),[Ke,Xo]=(0,E.useState)(t),[Qe,Yo]=(0,E.useState)(n),[et,Ko]=(0,E.useState)(i);return E.default.createElement(V,{title:"Interface Settings",description:"Set your Spotify interface settings."},J([{id:"controlSettings",conditionalRender:oe,cardProps:{title:"Set Control Height",tooltip:"Set the height of your window controls in pixels.",type:"input",settings:{type:"number",label:"Enter Control Height",defaultValue:e,onChange:v=>{b(Number(v))},settings:{step:1,min:1,max:64}}}},{id:"themeSettings",conditionalRender:!0,cardProps:{title:"Settings Access Position",tooltip:"Choose how to access settings: via the context menu button or a navigation button.",type:"dropdown",settings:{options:ct,placeholder:Ye,selectedValue:Ye,onChange:v=>{Jo(v)}}}},{id:"npvSettings",conditionalRender:!0,cardProps:{title:"Set Right Sidebar Mode",tooltip:E.default.createElement(E.default.Fragment,null,E.default.createElement("h3",{className:"encore-text encore-text-medium-bold"},"Select how the right sidebar appears during playback."),E.default.createElement("span",null,"Choose 'Compact' for a minimized view or 'Normal' for a detailed layout")),type:"dropdown",settings:{options:dt,placeholder:s,selectedValue:s,onChange:v=>{x(v)}}}},{id:"npvSettings",conditionalRender:s==="compact",cardProps:{title:"Set Compact Sidebar Position",tooltip:E.default.createElement(E.default.Fragment,null,E.default.createElement("h3",{className:"encore-text encore-text-medium-bold"},"Select where the right sidebar appears.")),type:"dropdown",settings:{options:pt,placeholder:m,selectedValue:m,onChange:v=>{F(v)}}}},{id:"npvSettings",sectionName:"Styles",conditionalRender:s==="compact",cardProps:{title:"Set Npv Background Blur",type:"input",settings:{label:"Npv Background Blur input",defaultValue:g,onChange:v=>{N(Number(v))},type:"number",settings:{max:256,min:0,step:.5}}}},{id:"font",conditionalRender:!0,cardProps:{title:"Font",type:"input",tooltip:E.default.createElement(E.default.Fragment,null,"Supports both Google Fonts via URL and local fonts.",E.default.createElement("span",null,"For Google Fonts, use the full URL (e.g., https://fonts.googleapis.com/css2?family=Roboto). "),E.default.createElement("span",null,"For local fonts, type the font family name (e.g., 'Arial').")),settings:{type:"text",label:"Font Family or URL",defaultValue:o,onChange:v=>{f("body",ht(v.toString()))}}}},{id:"grains",conditionalRender:!0,cardProps:{type:"dropdown",title:"Grains",tooltip:"Choose a grain texture mode.",settings:{options:it,placeholder:Ke,selectedValue:Ke,onChange:v=>{Xo(v),M(v)}}}},{id:"pageSettings",sectionName:"Pages Setting",conditionalRender:!0,cardProps:{type:"dropdown",title:"Pages Background Image",tooltip:"Choose a background image mode for playlist pages.",settings:{options:at,placeholder:Qe,selectedValue:Qe,onChange:v=>{Yo(v),k(v)}}}},{id:"pageSettings",conditionalRender:!0,cardProps:{type:"dropdown",tooltip:"Sets the view mode for playlists.",title:"Playlist View",settings:{options:st,placeholder:et,selectedValue:et,onChange:v=>{Ko(v),S(v)}}}},{id:"pageSettings",conditionalRender:!0,cardProps:{title:"Toggle Playlist Scroll Mode",tooltip:"Enable or disable scrolling for the playlist art image.",type:"toggle",settings:{checked:r,label:"Scroll Mode Toggle",onChange:v=>{y(v)}}}},{id:"borderSettings",conditionalRender:!0,sectionName:"Border Settings",cardProps:{title:"Border Thickness",type:"input",settings:{type:"number",label:"Border Thickness",defaultValue:l,onChange:v=>{qo(Number(v))},settings:{step:1,min:0,max:8}}}},{id:"borderSettings",conditionalRender:!0,sectionName:"Border Settings",cardProps:{title:"Rounded Border Radius",type:"input",settings:{type:"number",label:"Rounded Border Radius",defaultValue:d,onChange:v=>{Zo(Number(v))},settings:{step:1,min:0,max:999}}}},{id:"borderSettings",conditionalRender:!0,cardProps:{title:"Border Color",type:"input",settings:{type:"text",label:"Border Color",defaultValue:a,onChange:v=>{ue(v)}}}},{id:"borderSettings",conditionalRender:!0,cardProps:{title:"Border Style",type:"dropdown",settings:{options:lt,selectedValue:c,onChange:v=>{zo(v)}}}}]))},Vt=Ar;var Le=p(u()),Br=()=>{let{playbarSettings:{mode:e,styles:o},setPlaybarMode:t,updatePlaybarStyle:r}=h(),[n,i]=(0,Le.useState)(e),c=[{id:"playbarOption",conditionalRender:!0,cardProps:{title:"Playbar Option",type:"dropdown",settings:{placeholder:n,selectedValue:n,options:nt,onChange:l=>{i(l),t(l)}}}},...ke(o,e,r)];return Le.default.createElement(V,{title:"Playbar Settings",description:"Set your Spotify Now Playing Bar settings."},J(c))},Ht=Br;var jt=p(u()),Or=()=>{let{resetAllSettings:e}=h();return jt.default.createElement(V,{title:"Reset Settings",description:"Reset your theme settings."},J([{id:"resetButtonCard",conditionalRender:!0,cardProps:{title:"Reset All Settings",type:"button",settings:{variant:"danger",size:"medium",children:"Reset",onClick:()=>{window.confirm("Are you sure you want to reset all settings to their default values? This action cannot be undone.")&&e()}}}}]))},Gt=Or;var D=p(u()),Rr={settings:!1,changelog:!1},Dr=()=>{let e=(0,D.createContext)(null);return{ModalContextProvider:({children:r})=>{let[n,i]=(0,D.useState)(Rr),a=(0,D.useCallback)(l=>{let d=n[l],s=(0,D.useCallback)(()=>{i(g=>({...g,[l]:!0}))},[l]),m=(0,D.useCallback)(()=>{i(g=>({...g,[l]:!1}))},[l]);return{isOpen:d,openModal:s,closeModal:m}},[n]),c=(0,D.useMemo)(()=>a,[a]);return D.default.createElement(e.Provider,{value:c},r)},useModal:r=>{let n=(0,D.useContext)(e);if(n)return n(r);throw new Error("Wrap Element with ModalContextProvider")}}},{ModalContextProvider:Wt,useModal:X}=Dr();var j=p(u()),Ur=(0,j.memo)(()=>{let{isOpen:e,closeModal:o}=X("settings");return j.default.createElement(ve,{title:"Lucid Settings",onClose:o,isOpen:e},j.default.createElement("div",{className:"sections-container"},j.default.createElement(Et,null),j.default.createElement(Vt,null),j.default.createElement(Ht,null),j.default.createElement(Gt,null),j.default.createElement(Lt,null)))}),zt=Ur;var Te=p(u()),$r=()=>{w("hook running useSettingsAccess");let{settingAccessPosition:e}=h(),{openModal:o}=X("settings"),t=(0,Te.useRef)(null);(0,Te.useEffect)(()=>{if(e==="context-menu"&&(t.current=new Spicetify.Menu.Item("Lucid Settings",!1,o,'<svg width="16" height="16" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="#fff"/></svg>'),t.current.register()),e==="nav"&&!document.querySelector(".main-actionButtons button[aria-label='Lucid Settings']")&&!(t.current instanceof HTMLButtonElement)){let r=new Spicetify.Topbar.Button("Lucid Settings",'<svg width="24" height="24" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12.012 2.25c.734.008 1.465.093 2.182.253a.75.75 0 0 1 .582.649l.17 1.527a1.384 1.384 0 0 0 1.927 1.116l1.401-.615a.75.75 0 0 1 .85.174 9.792 9.792 0 0 1 2.204 3.792.75.75 0 0 1-.271.825l-1.242.916a1.381 1.381 0 0 0 0 2.226l1.243.915a.75.75 0 0 1 .272.826 9.797 9.797 0 0 1-2.204 3.792.75.75 0 0 1-.848.175l-1.407-.617a1.38 1.38 0 0 0-1.926 1.114l-.169 1.526a.75.75 0 0 1-.572.647 9.518 9.518 0 0 1-4.406 0 .75.75 0 0 1-.572-.647l-.168-1.524a1.382 1.382 0 0 0-1.926-1.11l-1.406.616a.75.75 0 0 1-.849-.175 9.798 9.798 0 0 1-2.204-3.796.75.75 0 0 1 .272-.826l1.243-.916a1.38 1.38 0 0 0 0-2.226l-1.243-.914a.75.75 0 0 1-.271-.826 9.793 9.793 0 0 1 2.204-3.792.75.75 0 0 1 .85-.174l1.4.615a1.387 1.387 0 0 0 1.93-1.118l.17-1.526a.75.75 0 0 1 .583-.65c.717-.159 1.45-.243 2.201-.252Zm0 1.5a9.135 9.135 0 0 0-1.354.117l-.109.977A2.886 2.886 0 0 1 6.525 7.17l-.898-.394a8.293 8.293 0 0 0-1.348 2.317l.798.587a2.881 2.881 0 0 1 0 4.643l-.799.588c.32.842.776 1.626 1.348 2.322l.905-.397a2.882 2.882 0 0 1 4.017 2.318l.11.984c.889.15 1.798.15 2.687 0l.11-.984a2.881 2.881 0 0 1 4.018-2.322l.905.396a8.296 8.296 0 0 0 1.347-2.318l-.798-.588a2.881 2.881 0 0 1 0-4.643l.796-.587a8.293 8.293 0 0 0-1.348-2.317l-.896.393a2.884 2.884 0 0 1-4.023-2.324l-.11-.976a8.988 8.988 0 0 0-1.333-.117ZM12 8.25a3.75 3.75 0 1 1 0 7.5 3.75 3.75 0 0 1 0-7.5Zm0 1.5a2.25 2.25 0 1 0 0 4.5 2.25 2.25 0 0 0 0-4.5Z" fill="currentColor"/></svg>',o,!1,!0);t.current=r}return()=>{t.current instanceof Spicetify.Menu.Item&&t.current.deregister(),t.current instanceof Spicetify.Topbar.Button&&t.current.element.remove(),document.querySelector(".Root__globalNav .main-actionButtons div:has(button[aria-label='Lucid Settings'])")?.remove()}},[e,o])},qt=$r;var se=p(u()),Fr=(0,se.memo)(()=>{w("Render <SettingsManager />");let{isOpen:e}=X("settings");return qt(),se.default.createElement(se.default.Fragment,null,e&&se.default.createElement(zt,null))}),Zt=Fr;var Ne=(e,o)=>[e,o].filter(Boolean).join(" ").trim(),_e=e=>{if(!Object.keys(e).length)return{};let o={};return e.blur!==void 0&&(o.filter=Ne(o.filter,`blur(${e.blur}px)`)),e.backdropBlur!==void 0&&(o.backdropFilter=`blur(${e.backdropBlur}px)`),e.contrast!==void 0&&(o.filter=Ne(o.filter,`contrast(${e.contrast})`)),e.brightness!==void 0&&(o.filter=Ne(o.filter,`brightness(${e.brightness})`)),e.saturation!==void 0&&(o.filter=Ne(o.filter,`saturate(${e.saturation})`)),e.opacity!==void 0&&(o.opacity=e.opacity),e.width!==void 0&&(o.width=`${e.width}px`),e.height!==void 0&&(o.height=`${e.height}px`),(e.paddingX!==void 0||e.paddingY!==void 0)&&(o.padding=`${e.paddingY||0}px ${e.paddingX||0}px`),e.borderRadius!==void 0&&(o.borderRadius=`${e.borderRadius}px`),e.backgroundColor!==void 0&&(o.backgroundColor=`${e.backgroundColor}`),o},Ae=(e,o=!1)=>{if(!Object.keys(e).length)return o?"":{};let t={};return e.blur!==void 0&&(t["--blur"]=`${e.blur}px`),e.backdropBlur!==void 0&&(t["--backdrop-blur"]=`${e.backdropBlur}px`),e.contrast!==void 0&&(t["--contrast"]=e.contrast),e.brightness!==void 0&&(t["--brightness"]=e.brightness),e.saturation!==void 0&&(t["--saturation"]=e.saturation),e.width!==void 0&&(t["--width"]=`${e.width}px`),e.height!==void 0&&(t["--height"]=`${e.height}px`),e.paddingX!==void 0&&(t["--padding-x"]=`${e.paddingX}px`),e.borderRadius!==void 0&&(t["--border-radius"]=`${e.borderRadius}px`),e.backgroundColor!==void 0&&(t["--background-color"]=e.backgroundColor),e.time!==void 0&&(t["--time"]=`${e.time}s`),e.opacity!==void 0&&(t["--opacity"]=e.opacity),o?Object.entries(t).map(([r,n])=>`${r}: ${n};`).join(" "):t};var le=p(u()),Vr=({style:e})=>le.default.createElement("div",{className:"animated-background-container",style:{...Ae(e)}},le.default.createElement("div",{className:"back"}),le.default.createElement("div",{className:"backleft"}),le.default.createElement("div",{className:"backright"}),le.default.createElement("div",{className:"front"})),Jt=Vr;var Xt=p(u()),Hr=({style:e})=>Xt.default.createElement("div",{className:"solid-background",style:{..._e(e)}}),Ze=Hr;var jr={underMainBackgroundImage:"",pageCategory:"other",artworkData:{nowPlayingArtURL:"",currentPageURI:"",currentPageArtURL:""},windowZoom:1},T=ne(e=>({...jr,updateArtworkData:o=>e(t=>({...t,artworkData:{...t.artworkData,...o}})),setPageCategory:o=>e(t=>({...t,pageCategory:o})),setUnderMainViewBackgroundImage:o=>e(t=>({...t,underMainBackgroundImage:o})),setIsCustomControls:o=>e(t=>({...t,isCustomControls:o})),setWindowZoom:o=>e(t=>({...t,windowZoom:o}))}));var Yt=p(u()),Gr=({style:e})=>{let{backgroundSettings:{customBackgroundOverride:o}}=h(),{artworkData:t}=T(),{isUseLocalImage:r,selectedLocalImage:n}=ie(),i=(()=>{if(r&&n?.dataURL)return n.dataURL;let a=o.url;return a==="current-page"?t?.currentPageArtURL||t?.nowPlayingArtURL||"":!a||a.trim()===""||a==="now-playing"?t?.nowPlayingArtURL||"":a||""})();return Yt.default.createElement("div",{className:"static-background",style:{backgroundImage:`url("${i}")`,..._e(e)}})},Kt=Gr;var Be=p(u()),Wr={animated:Jt,static:Kt,solid:Ze},zr=()=>{w("Render <BackgroundManager />");let{backgroundSettings:{mode:e,styles:o}}=h(),t=o[e],r=Wr[e];return Be.default.createElement("div",{className:"background-wrapper"},r?Be.default.createElement(r,{style:t}):Be.default.createElement(Ze,{style:{backgroundColor:"#202020"}}))},Qt=zr;var eo=async()=>{await(async()=>{for(;!Spicetify?.Player?.data;)await new Promise(n=>setTimeout(n,100))})();let{item:o}=Spicetify.Player.data;return!o||!o.metadata?(C("No item or metadata found in Spicetify Player data."),""):[o.metadata.image_xlarge_url,o.metadata.image_large_url,o.metadata.image_url,o.metadata.image_small_url].find(n=>n)||qr()||""},qr=()=>document.querySelector(".Root__right-sidebar .main-nowPlayingView-nowPlayingWidget .main-image-image")?.src||"",Zr=async e=>{let t=0;for(;t<=3;)try{let r=await Spicetify.GraphQL.Request({name:"queryArtistOverview",operation:"query",sha256Hash:"35648a112beb1794e39ab931365f6ae4a8d45e65396d641eeda94e4003d41497",value:null},{uri:e,includePrerelease:!0,locale:null});if(r)return r}catch(r){if(r instanceof Error&&r.message.includes("DUPLICATE_REQUEST_ERROR")&&t<3){t++,xe(`Duplicate request detected (getArtistMetaData). Retrying in 1 second... (Attempt ${t})`),await new Promise(n=>setTimeout(n,1e3));continue}throw C("Error fetching artist metadata:",r),r}},Jr=async e=>{let t=0;for(;t<=3;)try{let r=await Spicetify.GraphQL.Request({name:"getAlbum",operation:"query",sha256Hash:"469874edcad37b7a379d4f22f0083a49ea3d6ae097916120d9bbe3e36ca79e9d",value:null},{uri:e,locale:null,offset:0,limit:50});if(r)return r}catch(r){if(r instanceof Error&&r.message.includes("DUPLICATE_REQUEST_ERROR")&&t<3){t++,xe(`Duplicate request detected (getAlbumMetaData). Retrying in 1 second... (Attempt ${t})`),await new Promise(n=>setTimeout(n,1e3));continue}throw C("Error fetching album metadata:",r),r}},to=e=>{let o=Spicetify.URI.isPlaylistV1OrV2(e),t=Spicetify.URI.isArtist(e),r=Spicetify.URI.isAlbum(e),n=Spicetify.URI.isShow(e),i=Spicetify.URI.isProfile(e);if(o||t||r||i||n){let a=e.match(/\/(?:playlist|artist|album|user|show)\/([^/]+)/)?.[1];return a?`spotify:${o?"playlist":t?"artist":r?"album":n?"show":"user"}:${a}`:(xe("No ID found in pathname:",e),null)}return null},oo=async e=>{let o=e.split(":")[1];try{switch(o){case"playlist":case"show":return(await Spicetify.Platform.PlaylistAPI.getMetadata(e)).images.find(r=>r.url)?.url||null;case"artist":{let t=await Zr(e);return t.data?.artistUnion.visuals.headerImage?.sources?.[0]?.url||t.data?.artistUnion.visuals.avatarImage?.sources?.[0]?.url||null}case"album":{let t=await Jr(e);return t.data?.albumUnion.coverArt.sources?.[2]?.url||t.data?.albumUnion.coverArt.sources?.[0]?.url||null}case"user":return(await Spicetify.Platform.RequestBuilder.build().withHost("https://spclient.wg.spotify.com/user-profile-view/v3").withPath(`/profile/${e.split(":")[2]}`).send())?.body?.image_url||null;default:return null}}catch(t){return C(`Error fetching artwork for ${o}:`,t),null}};var ce=p(u()),Xr=()=>{w("Render <ArtworkManager />");let{pageCategory:e,artworkData:o,updateArtworkData:t}=T(),{interfaceSettings:{pagesSettings:r}}=h(),n=(0,ce.useCallback)(async()=>{let i=Spicetify.Platform.History.location.pathname,a=to(i);if(o.currentPageURI!==a){document.documentElement.style.setProperty("--artwork-opacity","0");try{if(a){let c=await oo(a)||"";t({currentPageArtURL:c,currentPageURI:a})}else t({currentPageArtURL:"",currentPageURI:""})}catch(c){C("Error updating artwork:",c),t({currentPageArtURL:"",currentPageURI:""})}finally{setTimeout(()=>document.documentElement.style.setProperty("--artwork-opacity","1"),500)}}},[o.currentPageURI,t]);return(0,ce.useEffect)(()=>{if(o.currentPageArtURL?(document.documentElement.style.setProperty("--playlist-art-image",`url(${o.currentPageArtURL})`),H(`Updated Playlist Artwork URL to ${o.currentPageArtURL}`)):o.currentPageURI&&e!=="other"&&(C(`No artwork URL found for URI: ${o.currentPageURI}`),document.documentElement.style.setProperty("--playlist-art-image","none")),r.backgroundImageMode==="inherit"){let i=Spicetify.Platform.History.listen(n);return n(),()=>{i()}}},[r.backgroundImageMode,o.currentPageArtURL,o.currentPageURI,e,n]),(0,ce.useEffect)(()=>{o.nowPlayingArtURL&&(document.documentElement.style.setProperty("--now-playing-art-image",`url("${o.nowPlayingArtURL}")`),H(`Updated Now Playing Art View: ${o.nowPlayingArtURL}`))},[o.nowPlayingArtURL]),(0,ce.useEffect)(()=>{let i=async()=>{let a=await eo();t({nowPlayingArtURL:a})};return i(),Spicetify.Player.addEventListener("songchange",i),()=>{Spicetify.Player.removeEventListener("songchange",i)}},[t]),null},ro=Xr;var no=p(u()),Yr=()=>{let{interfaceSettings:{borderSettings:e}}=h();return(0,no.useEffect)(()=>{let t=(r=>Object.keys(r).length?Object.entries(r).map(([n,i])=>`--border-${n}: ${n==="thickness"||n==="roundedRadius"?`${i}px`:i};`).join(" "):"")(e);document.documentElement.style.cssText+=t},[e]),null},io=Yr;var Oe=(e,o,t)=>`#${(e<<16|o<<8|t).toString(16).padStart(6,"0")}`,ao=(e,o,t)=>{let[r,n,i]=[e/255,o/255,t/255],[a,c,l]=[r<=.03928?r/12.92:((r+.055)/1.055)**2.4,n<=.03928?n/12.92:((n+.055)/1.055)**2.4,i<=.03928?i/12.92:((i+.055)/1.055)**2.4];return .2126*a+.7152*c+.0722*l},ye=(e,o)=>({...e,r:Math.max(0,Math.round(e.r*o)),g:Math.max(0,Math.round(e.g*o)),b:Math.max(0,Math.round(e.b*o)),hex:Oe(Math.max(0,Math.round(e.r*o)),Math.max(0,Math.round(e.g*o)),Math.max(0,Math.round(e.b*o)))}),G=(e,o)=>({...e,r:Math.min(255,Math.round(e.r+(255-e.r)*o)),g:Math.min(255,Math.round(e.g+(255-e.g)*o)),b:Math.min(255,Math.round(e.b+(255-e.b)*o)),hex:Oe(Math.min(255,Math.round(e.r+(255-e.r)*o)),Math.min(255,Math.round(e.g+(255-e.g)*o)),Math.min(255,Math.round(e.b+(255-e.b)*o)))}),Re=(e,o)=>{let t=ao(e.r,e.g,e.b),r=ao(o.r,o.g,o.b),n=Math.max(t,r),i=Math.min(t,r);return(n+.05)/(i+.05)};var De=p(po());async function pn(e){try{let o=await(0,De.loadImage)(e),t=10,r=Math.max(o.width/t,10),n=Math.max(o.height/t,10),a=(0,De.createCanvas)(r,n).getContext("2d");a.drawImage(o,0,0,r,n);let l=a.getImageData(0,0,r,n).data,d={},s={},g=Math.floor(l.length*.2);for(let y=0;y<g;y+=4){let x=l[y],N=l[y+1],F=l[y+2],ue=`${x}-${N}-${F}`;d[ue]=(d[ue]||0)+1,s[ue]={r:x,g:N,b:F,hex:Oe(x,N,F)}}let f=Object.entries(d).sort((y,x)=>x[1]-y[1]).map(([y])=>s[y]),M=f[0],b=f[1],k=f[2],S=2;for(;!b||Re(M,b)<2.5;){if(S>=f.length){b=G(M,.2);break}b=f[S],S++}for(;!k||Re(M,k)<2.5||Re(b,k)<2.5;){if(S>=f.length){k=G(b,.2);break}k=f[S],S++}return{baseColor:M,secondaryColor:b,tertiaryColor:k}}catch(o){return C("Error extracting colors: ",o),o}}var Xe=null;async function uo(e,o,t){return!o||!t?null:new Promise(r=>{Xe&&clearTimeout(Xe),Xe=setTimeout(async()=>{try{let n=await pn(t);if(n instanceof Error){C(`Error extracting colors: ${n.message}`),r(null);return}let i=mn(n);un(e,i),r(n)}catch(n){C("Error saving colors to style: ",n instanceof Error?n.message:n),r(null)}},200)})}function un(e,o){let t=`:root {${Object.entries(o).map(([r,n])=>`
--spice-${r}: ${n.hex} !important;
--spice-rgb-${r}: ${n.r}, ${n.g}, ${n.b} !important;`).join("")}
}`;t+=`:root{
will-change: --spice-main,--spice-rgb-main,--spice-sidebar,--spice-rgb-sidebar,--spice-card,--spice-rgb-card,--spice-player,--spice-rgb-player,--spice-accent,--spice-rgb-accent,--spice-highlight,--spice-rgb-highlight,--spice-button,--spice-rgb-button,--spice-button-active,--spice-rgb-button-active,--spice-text,--spice-rgb-text,--spice-progress-bar,--spice-rgb-progress-bar,--spice-subtext,--spice-rgb-subtext,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;
transition: all 0.3s ease-in-out;
}`,e.textContent=t}async function mo(e){e.textContent=`:root{
will-change: --spice-main,--spice-rgb-main,--spice-sidebar,--spice-rgb-sidebar,--spice-card,--spice-rgb-card,--spice-player,--spice-rgb-player,--spice-accent,--spice-rgb-accent,--spice-highlight,--spice-rgb-highlight,--spice-button,--spice-rgb-button,--spice-button-active,--spice-rgb-button-active,--spice-text,--spice-rgb-text,--spice-progress-bar,--spice-rgb-progress-bar,--spice-subtext,--spice-rgb-subtext,--spice-primary,--spice-rgb-primary,--spice-secondary,--spice-rgb-secondary,--spice-tertiary,--spice-rgb-tertiary;
transition: all 0.3s ease-in-out;
}`}function mn({baseColor:e,secondaryColor:o,tertiaryColor:t}){return{main:ye(o,.4),sidebar:ye(o,.5),card:ye(t,.5),player:ye(o,.6),"progress-bar":G(o,.6),accent:G(e,.4),highlight:G(o,.2),button:G(t,.4),"button-active":G(t,.4),text:G(e,.9),subtext:G(o,.9),primary:e,secondary:o,tertiary:t}}var de=p(u()),gn=()=>{w("Render <ColorManager />");let{colorSettings:{isDynamicColor:e}}=h(),{artworkData:o}=T(),{selectedLocalImage:t,isUseLocalImage:r}=ie(),n=(0,de.useRef)(null),i=(0,de.useRef)(null);return(0,de.useEffect)(()=>(n.current=document.createElement("style"),n.current.id="lucid_dynamic_colors",document.head.appendChild(n.current),()=>{n.current&&document.head.removeChild(n.current)}),[]),(0,de.useEffect)(()=>{if(!e){i.current&&(i.current=null),n.current&&mo(n.current);return}e&&(o.nowPlayingArtURL!==i.current||t?.dataURL)&&(n?.current&&e&&o.nowPlayingArtURL&&uo(n.current,e,r&&t?.dataURL||o.nowPlayingArtURL).then(()=>{H("Dynamic colors updated!")}).catch(a=>{C("Error updating colors:",a)}),i.current=r&&t?.dataURL||o.nowPlayingArtURL)},[e,o.nowPlayingArtURL,t?.dataURL,r]),null},go=gn;var Se=p(u()),fn=()=>{let{interfaceSettings:{fontSettings:e}}=h(),o=(0,Se.useCallback)((r,n)=>{document.documentElement.style.setProperty(`--${r}-font-to-use`,n)},[]),t=(0,Se.useCallback)(async r=>{let{fontFamily:n,url:i}=e[r];try{await St(i,`${r}-font`),o(r,n)}catch(a){C(`Failed to load font from ${i}`,a),o(r,n)}},[e,o]);return(0,Se.useEffect)(()=>{Object.keys(e).map(r=>t(r))},[e,t]),null},fo=fn;var yo=p(u()),A=e=>{(0,yo.useEffect)(()=>{if(e)return document.body.classList.add(e),()=>{document.body.classList.remove(e)}},[e])};var yn=()=>(w("Render <GlobalNavManager />"),A(Ft?"global-nav":"control-nav"),null),bo=yn;var So=p(u()),bn=()=>{w("Render <GrainManager />");let{interfaceSettings:{grainSettings:{grainEffect:e}}}=h();return A(`grain-${e}`),So.default.createElement("div",{id:"grainEffect","data-grainEffect":e})},ho=bn;var Sn=()=>{let{npvSettings:{mode:e,position:o,blur:t}}=h();return document.body.style.setProperty("--compact-npv-blur",`${t}px`),A(`${e}-npv`),A(`${o}-npv`),null},vo=Sn;var wo=e=>Spicetify.URI.isPlaylistV1OrV2(e)?"playlist":Spicetify.URI.isArtist(e)?"artist":Spicetify.URI.isAlbum(e)?"album":Spicetify.URI.isGenre(e)?"genre":Spicetify.URI.isShow(e)?"show":Spicetify.URI.isSearch(e)?"search":Spicetify.URI.isProfile(e)?"profile":Spicetify.URI.isConcert(e)||Spicetify.URI.isArtistConcerts(e)?"concert":"other";var Co=p(u()),hn=()=>{let{pageCategory:e,setPageCategory:o}=T();return A(e),(0,Co.useEffect)(()=>{let t=()=>{let n=Spicetify.Platform.History.location.pathname;o(wo(n))};t();let r=Spicetify.Platform.History.listen(()=>{t()});return()=>{r()}},[o]),null},ko=hn;var Ue=p(u()),Mo=".Root__now-playing-bar",vn=()=>{let{playbarSettings:e}=h(),o=(0,Ue.useRef)(document.querySelector(Mo));return A(`playbar-${e.mode}`),(0,Ue.useEffect)(()=>{if(!o.current){C(`Playbar element with class '${Mo}' not found!`);return}let{mode:t,styles:r}=e,n=Ae(r[t],!0),i=t==="compact"?r[t].height:o.current?.clientHeight||r[t]?.height;document.documentElement.style.setProperty("--playbar-height",`${i}px`),o.current.style.cssText=n.toString()},[e]),null},xo=vn;var he=p(u()),wn=()=>{let{underMainBackgroundImage:e,setUnderMainViewBackgroundImage:o}=T(),t=(0,he.useCallback)(r=>{let n=r.reduce((a,c)=>{if(a)return a;if(c.type==="childList"&&c.addedNodes.length>0){let l=c.addedNodes[0];if(l.firstChild instanceof HTMLDivElement)return l.firstChild}return null},null),i=null;n?.style?i=n.style.backgroundImage.replace(/url\(['"]?([^'"]*)['"]?\)/i,"$1"):e!==null&&(i=null),o(i)},[o,e]);(0,he.useEffect)(()=>{let r=new MutationObserver(t),n=document.querySelector(".under-main-view");return n&&r.observe(n,{childList:!0}),()=>r.disconnect()},[t]),(0,he.useEffect)(()=>(document.documentElement.style.setProperty("--under-main-view-art-image",e?`url(${e})`:null),()=>{document.documentElement.style.removeProperty("--under-main-view-art-image")}),[e])},Po=wn;var U=p(u()),Cn=()=>{let{interfaceSettings:{pagesSettings:{playlistViewMode:e,isScrollMode:o,backgroundImageMode:t}}}=h(),{pageCategory:r,underMainBackgroundImage:n,artworkData:i}=T(),a=(0,U.useRef)(null),c=(0,U.useRef)(null);A(`${Ut}${e}`),A(`${Dt}${t}`),A(`${n?"under-main-view-present":""}`);let l=(0,U.useCallback)(g=>{let{current:f}=a;if(f){let M=Math.min(g.scrollTop,window.innerHeight);f.style.transform=`translate3d(0, ${o?-M:0}px, 0)`,f.style.setProperty("--scroll",`${M/1e3}`)}},[o]),d=(0,U.useMemo)(()=>r!=="artist"&&!n?4:0,[r,n]);(0,U.useEffect)(()=>{let{current:g}=c;g&&g.style.setProperty("--blur",`${d}px`)},[d]),(0,U.useEffect)(()=>{let g=document.querySelector(Rt);if(g){let f=()=>l(g);return f(),g.addEventListener("scroll",f,{passive:!0}),()=>{g.removeEventListener("scroll",f)}}},[l]),w("New underMainBackgroundImage:",n);let s=r!=="other"&&t!=="none"?n||(t==="inherit"?i.currentPageArtURL||"":i.nowPlayingArtURL||""):"none",m=`playlist-art-container ${e} ${t}`;return U.default.createElement("span",{id:"playlistArtContainer",className:m,"data-playlist-view-mode":e,ref:a},U.default.createElement("div",{className:"background",ref:c,style:{backgroundImage:`url(${s})`}}),U.default.createElement("div",{className:"overlay",style:{height:"100%",width:"100%",position:"absolute",inset:0}}))},Io=Cn;var pe=p(u()),Eo=()=>{let e=(0,pe.useRef)(null);(0,pe.useEffect)(()=>{let o=()=>{if(document.getElementById("lucid-under-main-view"))return;let r=document.createElement("div");r.id="lucid-under-main-view",r.className="lucid-under-main-view";let n=document.querySelector(".main-view-container");n&&n.prepend(r),e.current=r,e.current&&Spicetify.ReactDOM.createRoot(e.current).render(pe.default.createElement(Io,null))};o();let t=Spicetify.Platform.History.listen(()=>{o()});return()=>{t()}},[])};var kn=()=>(w("Render <UnderMainViewManager />"),Eo(),Po(),null),Lo=kn;var Y=p(u()),Mn=()=>{let e=(0,Y.useRef)(null),[o,t]=(0,Y.useState)({}),{windowZoom:r}=T(),{interfaceSettings:{controlSettings:{height:n}}}=h();return(0,Y.useEffect)(()=>{let i=()=>{if(oe)if(At(n),!Ee&&!$t){let l=n||(qe?32:64),d=qe?(n/r-Math.min(32/r,n/r))/2:0,s=l/r-d*2;window.document.body.style.setProperty("--top-bar-padding-start",`${(n<=16?8:64)/r}px`),window.document.body.style.setProperty("--top-bar-padding-end",`${(n<=16?8:135)/r}px`);let m={position:"fixed",right:0,top:`${d}px`,height:`${s}px`,width:`${135/r}px`,WebkitBackdropFilter:"brightness(2.12)",backdropFilter:"brightness(2.12)",pointerEvents:"none",zIndex:"var(--above-main-and-now-playing-view-grid-area, 6)"};t(m)}else t({})};i();let a=()=>{i()},c=setTimeout(i,1e3);return window.addEventListener("resize",a),()=>{clearTimeout(c),window.removeEventListener("resize",a)}},[r,n]),Y.default.createElement("div",{ref:e,style:o})},To=Mn;var re=p(u()),xn=(0,re.memo)(()=>re.default.createElement(re.default.Fragment,null,oe?re.default.createElement("div",{id:"transperent-controls-container",style:{containerType:"normal",pointerEvents:"none"}},!Ee&&oe?re.default.createElement(To,null):null):null)),No=xn;var q=p(u()),Pn=()=>{let e=(0,q.useRef)({outerWidth:window.outerWidth,innerWidth:window.innerWidth,ratio:window.devicePixelRatio}),{windowZoom:o,setWindowZoom:t}=T(),r=(0,q.useRef)(window.outerWidth),n=(0,q.useRef)(window.innerWidth),i=(0,q.useRef)(window.devicePixelRatio),a=(0,q.useRef)(!0),c=(0,q.useRef)(document.querySelector(".Root__main-view"));return(0,q.useEffect)(()=>{let l=()=>{document.documentElement.style.setProperty("--main-view-height",`${c.current?.clientHeight}px`);let s=window.outerWidth,m=window.innerWidth,g=window.devicePixelRatio;if(a.current||(r.current<=160||i.current!==g)&&(r.current!==s||n.current!==m)){let f=s/m||1;t(f),document.documentElement.style.setProperty("--zoom",`${f}`),w(`Zoom Updated: ${s} / ${m} = ${f}`),r.current=s,n.current=m,i.current=g}},d=()=>{l()};return l(),window.addEventListener("resize",d),()=>{window.removeEventListener("resize",d)}},[t]),null},_o=Pn;var B=p(u()),In=()=>(w("Render <MainStateManager />"),B.default.createElement(B.default.Fragment,null,B.default.createElement(ko,null),B.default.createElement(ho,null),B.default.createElement(go,null),B.default.createElement(_o,null),B.default.createElement(xo,null),B.default.createElement(ro,null),B.default.createElement(io,null),B.default.createElement(bo,null),B.default.createElement(fo,null),B.default.createElement(vo,null),B.default.createElement(Lo,null),B.default.createElement(No,null))),Ao=In;function Bo(e,o){e.innerHTML=`
    #lucid-main .background-container .background-wrapper div { z-index: ${o} !important; }
  `}function Oo(e){e.innerHTML=`
    #lucid-main .background-container .background-wrapper div { z-index: -1 !important; }
  `}function Ro(e,o,t,r){let n=!1,i=null,a=new MutationObserver(()=>{let l=e.querySelector(o);l!==i&&(l&&!n?(H(`Applying background z-index: ${r}`),n=!0,Bo(t,r)):n&&(H(`Removing background z-index: ${r}`),n=!1,document.querySelector("#lyrics-cinema .lyrics-lyrics-background, #lyrics-cinema .lyrics-lyrics-container")?Bo(t,5):Oo(t)),i=l)}),c={childList:!0};a.observe(e,c),Oo(t)}var Do=()=>{let e=document.getElementById("lucid-background-style");e||(e=document.createElement("style"),e.id="lucid-background-style",document.head.appendChild(e));let o=document.querySelector("#lyrics-cinema");o&&Ro(o,"#lyrics-cinema .lyrics-lyrics-background, #lyrics-cinema .lyrics-lyrics-container",e,5);let t=document.querySelector("#main .Root > div:last-child");t&&Ro(t,'.Root div[data-testid="fullscreen-mode-container"], .Root .npv-main-container',e,15)};var Uo=()=>{let{Locale:e}=Spicetify;function o(x){return x.replace(/[{0}{1}«»”“]/g,"").trim()}if(!e)return;let t=e.get("playlist.a11y.play")||"";t=o(t);let r=e.get("playlist.a11y.pause")||"";r=o(r);let n=e.get("play"),i=e.get("pause"),a=e.get("browse"),c=e.get("playback-control.skip-forward"),l=e.get("playback-control.skip-back"),d=e.get("tracklist.a11y.play")||"",s=e.get("view.web-player-home"),m=e.get("upgrade.tooltip.title")||"Upgrade to Premium",g,f;["zh-CN","zh-TW","am","fi"].includes(e.getLocale())?[g,f]=d.split("{1}"):[g,f]=d.split("{0}"),g=o(g),f=o(f);let M=e.get("playback-control.enable-repeat"),b=e.get("playback-control.enable-repeat-one"),k=e.get("playback-control.disable-repeat"),S="lucid_button_styles",y=document.getElementById(S);y||(y=document.createElement("style"),y.id=S,document.head.appendChild(y)),y.innerHTML=`
.Root__globalNav button[aria-label="${m}"],
.Root__globalNav button[title="${m}"] {
  display: none !important;
}

.main-repeatButton-button[aria-checked="false"],
.player-controls__right button[aria-label*="${M}"]  span{
  -webkit-mask-image: var(--repeat-off-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-off.svg"));
  mask-image: var(--repeat-off-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-off.svg"));
  background-color: var(--spice-subtext);
  mask-size: contain;
}

.main-repeatButton-button[aria-checked="mixed"],
.player-controls__right button[aria-label*="${k}"] span {
  -webkit-mask-image: var(--repeat-mixed-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-mixed.svg"));
  mask-image: var(--repeat-mixed-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat-mixed.svg"));
  background-color: var(--spice-accent);
  mask-size: contain;
}

.main-repeatButton-button[aria-checked="true"],
.player-controls__right button[aria-label*="${b}"] span {
  -webkit-mask-image: var(--repeat-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat.svg"));
  mask-image: var(--repeat-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/repeat.svg"));
  background-color: var(--spice-accent);
  mask-size: contain;
}

.player-controls__right button[aria-label*="${k}"] svg,
.player-controls__right button[aria-label*="${M}"] svg {
  transform: scale(1.15);
}

.player-controls__right button[aria-label*="${k}"] svg,
.player-controls__right button[aria-label*="${M}"] svg {
  visibility: hidden;
  opacity: 0;
}

.main-repeatButton-button {
  transform: scale(0.65) !important;
}

.player-controls__right, 
.player-controls__left {
    align-items: center;
}

.player-controls__buttons>button[aria-label*="${n}"] span,
.main-playButton-button[aria-label*="${n}"],
.main-playButton-PlayButton>button[aria-label*="${n}"]{
  background-color: var(--spice-text) !important;
  -webkit-mask-image: var(--play-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/play.svg")) !important;
  mask-image: var(--play-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/play.svg")) !important;
}

.main-playButton-button[aria-label*="${i}"],
.main-playButton-PlayButton>button[aria-label*="${i}"],
.main-playPauseButton-button[aria-label*="${i}"],
.player-controls__buttons>button[aria-label*="${i}"] span {
  background-color: var(--spice-text) !important;
  -webkit-mask-image: var(--pause-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/pause.svg")) !important;
  mask-image: var(--pause-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/pause.svg")) !important;
}

.Root__globalNav button:is([aria-label="Clear search field"]) {
  background-color: transparent !important;
  border: none !important;
}

button[aria-label="${a}"] path {
  display: none !important;
}

button[aria-label="${a}"] svg {
  -webkit-mask-size: contain;
  mask-size: contain;
  -webkit-mask-position: center;
  mask-position: center;
  -webkit-mask-image: var(--compass-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/compass-outline.svg"));
  mask-image: var(--compass-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/compass-outline.svg"));
  background-color: var(--spice-subtext) !important;
  scale: 1.25;
}

.main-repeatButton-button[aria-label="${M}"],
.main-repeatButton-button[aria-label="${k}"],
.main-repeatButton-button[aria-label="${b}"],
{
scale: 0.75 !important;
background-color: var(--spice-subtext) !important;
color: var(--spice-subtext);

svg {
  display: none;
}
}

.player-controls__buttons>button[aria-label*="${n}"] span,
.player-controls__buttons>button[aria-label*="${i}"] span{
  display: block;
  mask-size: 100%;
  -webkit-mask-position: center center;
  mask-position: center center;
  background-color: var(--spice-subtext);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: cover;
  mask-size: cover;
  aspect-ratio: 1/1;
}

.main-playPauseButton-button,
.player-controls button[aria-label="${l}"],
.player-controls button[aria-label="${c}"]
{
  display: block;
  mask-size: 100%;
  -webkit-mask-position: center center;
  mask-position: center center;
  background-color: var(--spice-subtext);
  -webkit-mask-repeat: no-repeat;
  mask-repeat: no-repeat;
  -webkit-mask-size: cover;
  mask-size: cover;
  min-height: 1rem;
  min-width: 1rem;
  aspect-ratio: 1/1;
  border-radius: 0 !important;
  border: none !important;
  height: var(--button-size, 24px);
  width: var(--button-size, 24px);
  
  svg,
  span {
    display: none;
    visibility: hidden;
  }
}

.player-controls__buttons>button[aria-label*="${n}"] span svg,
.player-controls__buttons>button[aria-label*="${i}"] span svg {
  display: none;
  visibility: hidden;
}

.player-controls button[aria-label="${l}"] span,
.player-controls button[aria-label="${c}"] span {
  opacity: 0;
}

.player-controls button[aria-label="${l}"] {
  background-color: var(--spice-text);
  -webkit-mask-image: var(--prev-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/prev.svg"));
  mask-image: var(--prev-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/prev.svg"));
}

.player-controls button[aria-label="${c}"] {
  background-color: var(--spice-text);
  -webkit-mask-image: var(--next-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/next.svg"));
  mask-image: var(--next-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/next.svg"));
}

.main-yourLibraryX-navLink[aria-label="${s}"] svg,
button[aria-label="${s}"] svg {
  path {
display: none !important;
  }

  mask-image: var(--home-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-outline.svg"));
  -webkit-mask-image: var(--home-outline-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-outline.svg"));
  background-color: var(--spice-subtext) !important;
}


.main-yourLibraryX-navLink[aria-label="${s}"].active svg,
.main-globalNav-navLinkActive[aria-label="${s}"] svg {
  path {
display: none !important;
  }

  mask-image: var(--home-filled-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-filled.svg"));
  -webkit-mask-image: var(--home-filled-icon, url("https://cdn.jsdelivr.net/gh/sanoojes/Spicetify-Lucid@refs/heads/main/assets/icons/home-filled.svg"));
  background-color: var(--spice-text) !important;
}

.main-yourLibraryX-navLink[aria-label="${s}"].active svg {
  path {
display: none !important;
  }

  background-color: var(--spice-accent) !important;
}

#context-menu ul[aria-label*="Add to playlist menu"] {
  p {
max-width: 10rem;
  }
}
`};var $=p(u());var K=p(u()),En=({releases:e,isLoading:o,error:t})=>o?K.default.createElement("div",null,"Loading release data..."):t?K.default.createElement("div",null,"Error fetching release data: ",t.message):e?K.default.createElement("div",{className:"lucid-changelog",id:"lucid-changelog"},e.map(r=>K.default.createElement("div",{key:r.tag_name,className:"release"},K.default.createElement("button",{className:"release-button",type:"button",onClick:()=>window.open(r.html_url,"_blank")},"View on GitHub"),r.body&&K.default.createElement("div",{className:"release-content",dangerouslySetInnerHTML:{__html:r.body}})))):K.default.createElement("div",null,"No release data found."),$o=En;var $e=p(u()),Fo=(e,o)=>{let[t,r]=(0,$e.useState)(()=>{if(typeof window<"u"){let n=window.localStorage.getItem(e);return n?JSON.parse(n):o}return o});return(0,$e.useEffect)(()=>{typeof window<"u"&&window.localStorage.setItem(e,JSON.stringify(t))},[e,t]),[t,r]};async function Vo(e,o,t){try{let r={text:e,context:`${o}/${t}`,mode:"gfm"},n=await fetch("https://api.github.com/markdown",{method:"POST",body:JSON.stringify(r)});if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);return await n.text()}catch(r){return C("Error parsing markdown:",r),null}}var Q=p(u()),Ln=({currentVersion:e})=>{let[o,t]=Q.default.useState({isLoading:!0,error:null,releases:null}),[r,n]=Fo("lucid:previousVersion",null),{closeModal:i,isOpen:a,openModal:c}=X("changelog"),l=async()=>{w("Fetching release data..."),t(s=>({...s,isLoading:!0}));try{let s=await fetch(Ot||"https://api.github.com/repos/sanoojes/spicetify-lucid/releases");if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);let m=await s.json();w("Fetched release data:",m);let g=await Promise.all(m.map(async M=>({...M,body:await Vo(M.body,"sanoojes","spicetify-lucid")||""})));t({isLoading:!1,error:null,releases:g});let f=m[0].tag_name;(r===null||f!==r)&&(console.log("Opening changelog modal because new version detected"),c())}catch(s){t(m=>({...m,isLoading:!1,error:s instanceof Error?s:new Error("Unknown error")})),C("Error fetching release data:",s)}};Q.default.useEffect(()=>{l()},[]);let d=Q.default.useCallback(()=>{i();let s=o.releases?.[0]?.tag_name;s&&n(s)},[i,o.releases,n]);return Q.default.createElement(Q.default.Fragment,null,Q.default.createElement(ve,{title:"Lucid Changelog",onClose:d,isOpen:a},Q.default.createElement($o,{releases:o.releases,isLoading:o.isLoading,error:o.error,currentVersion:e})))},Ho=Ln;var Tn=()=>(w("Render <Main />"),(0,$.useEffect)(()=>{Uo(),Do()},[]),$.default.createElement($.default.Fragment,null,$.default.createElement("div",{id:"background-container",className:"background-container",style:{containerType:"normal"}},$.default.createElement(Qt,null)),$.default.createElement(Wt,null,$.default.createElement("div",{id:"modal-container",className:"modal-container",style:{containerType:"normal"}},$.default.createElement(Zt,null),$.default.createElement(Ho,null))),$.default.createElement("div",{id:"state"},$.default.createElement(Ao,null)),$.default.createElement(mt,null))),jo=Tn;var Go=p(u());async function Nn(){try{for(;!Spicetify?.showNotification||!Spicetify?.Player||!Spicetify?.React||!Spicetify?.Platform;)await new Promise(o=>setTimeout(o,100));let e=document.getElementById("lucid-main");e||(e=document.createElement("div"),e.id="lucid-main",document.getElementById("main")?.prepend(e)),e&&!e.hasChildNodes()&&Spicetify.ReactDOM.createRoot(e).render(Go.default.createElement(jo,null)),console.log("%c Lucid ignited! \u{1F680}","font-weight: bold; font-size: 1.25rem; color: #2196F3; padding: 0.5rem 0;")}catch(e){Spicetify.showNotification(`[Lucid] Error Occurred: ${e instanceof Error?e.message:e}`,!0),C(e)}}var Wo=Nn;(async()=>await Wo())();})();
})();